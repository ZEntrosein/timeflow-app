# TimeFlow - 时间轴管理系统

一个基于React的现代化时间轴管理应用，专注于事件管理和对象关系可视化。

## 🚀 项目特色

### 🎯 核心功能
- **时间轴视图**: 直观的事件时间线显示
- **对象管理**: 分类管理人物、地点、项目等对象
- **交互式检查器**: 实时编辑事件和对象属性
- **多选操作**: 支持批量选择和操作
- **响应式设计**: 适配各种屏幕尺寸

### ✨ 最新更新 (v2.0)
- **🔄 对象管理重构**: 对象从时间轴中移除，通过侧边栏统一管理
- **✏️ 检查器编辑**: 可直接在检查器中编辑事件和对象信息
- **📋 对象列表弹窗**: 按类别查看和选择对象
- **🎨 优化UI**: 更现代的界面设计和交互体验

## 🏗️ 技术架构

### 前端技术栈
```typescript
React 18+         // 核心框架
TypeScript        // 类型安全
Vite             // 构建工具
Tailwind CSS     // 样式框架
Zustand          // 状态管理
Konva.js         // 2D 画布渲染
```

### 项目结构
```
timeflow-app/
├── src/
│   ├── components/        # React组件
│   │   ├── Dialogs/      # 弹窗组件
│   │   ├── Layout/       # 布局组件
│   │   ├── UI/           # 通用UI组件
│   │   └── Views/        # 视图组件
│   ├── store/            # 状态管理
│   ├── types/            # TypeScript类型定义
│   ├── constants/        # 常量配置
│   └── utils/            # 工具函数
├── public/               # 静态资源
└── docs/                 # 文档
```

## 🛠️ 安装与启动

### 环境要求
- Node.js >= 18.0.0
- pnpm >= 8.0.0 (推荐) 或 npm

### 快速开始
```bash
# 克隆项目
git clone <repository-url>
cd timeflow-app

# 安装依赖
pnpm install

# 启动开发服务器
pnpm dev

# 构建生产版本
pnpm build
```

## 📖 使用指南

### 基本操作

#### 🎬 事件管理
1. **创建事件**: 点击顶部状态栏的"+ 事件"按钮
2. **编辑事件**: 
   - 双击时间轴上的事件
   - 或在检查器中点击"编辑"按钮
3. **移动事件**: 直接拖拽事件到新的时间位置
4. **选择事件**: 单击选择，Ctrl+单击多选

#### 👥 对象管理
1. **查看对象**: 左侧边栏显示按类别分组的对象
2. **选择对象**: 点击对象类别 → 选择具体对象
3. **编辑对象**: 在检查器中点击"编辑"按钮
4. **创建对象**: 点击侧边栏底部的"创建新对象"按钮

#### 🔍 检查器编辑
1. **选择目标**: 选择事件或对象
2. **进入编辑模式**: 点击检查器面板中的"编辑"按钮
3. **修改属性**: 直接编辑表单字段
4. **保存更改**: 点击"保存"按钮确认修改

### 高级功能

#### ⌨️ 键盘快捷键
- `Escape`: 清除选择
- `Delete` / `Backspace`: 删除选中项目
- `Ctrl + 单击`: 多选模式
- `滚轮 + Ctrl`: 精细缩放

#### 🖱️ 鼠标操作
- **单击**: 选择项目
- **双击**: 编辑项目
- **拖拽**: 移动事件时间
- **右键**: 打开上下文菜单
- **滚轮**: 时间轴缩放

## 🎨 界面布局

### 主要区域
```
┌─────────────────────────────────────────────────┐
│                   工具栏                         │
├──────────┬─────────────────────┬─────────────────┤
│          │                     │                 │
│  侧边栏   │      时间轴视图      │    检查器面板    │
│ (对象管理) │    (事件显示)       │   (属性编辑)     │
│          │                     │                 │
├──────────┴─────────────────────┴─────────────────┤
│                  状态栏                          │
└─────────────────────────────────────────────────┘
```

### 检查器面板
- **📅 时间**: 编辑事件/对象的时间属性
- **📋 属性**: 编辑基本信息（名称、描述、类型等）
- **🔗 关系**: 管理对象间关系（开发中）
- **⚡ 依赖**: 管理依赖关系（开发中）
- **📎 附件**: 文件附件管理（开发中）

## 🗃️ 数据模型

### 事件 (TimelineEvent)
```typescript
interface TimelineEvent {
  id: string;              // 唯一标识
  title: string;           // 事件标题
  description?: string;    // 事件描述
  startTime: number;       // 开始时间
  endTime?: number;        // 结束时间（可选）
  category?: string;       // 事件类型
  location?: string;       // 发生地点
  tags?: string[];         // 标签列表
  participants?: string[]; // 参与者ID列表
  attributes?: Attribute[]; // 自定义属性
}
```

### 对象 (WorldObject)
```typescript
interface WorldObject {
  id: string;              // 唯一标识
  name: string;            // 对象名称
  description?: string;    // 对象描述
  category: string;        // 对象类型
  tags?: string[];         // 标签列表
  attributes: Attribute[]; // 自定义属性
  state?: DisplayState;    // 显示状态
}
```

### 自定义属性 (Attribute)
```typescript
interface Attribute {
  id: string;              // 属性ID
  name: string;            // 属性名称
  value: any;              // 属性值
  type: AttributeType;     // 属性类型
  createdAt: string;       // 创建时间
  updatedAt: string;       // 更新时间
}
```

## 🔧 开发指南

### 状态管理
项目使用 Zustand 进行状态管理，主要 Store 包括：

- **UIStore**: 界面状态管理
- **ProjectStore**: 项目数据管理
- **ViewStore**: 视图配置管理
- **SelectionStore**: 选择状态管理

### 添加新功能
1. 在 `types/index.ts` 中定义相关类型
2. 在对应的 Store 中添加状态和操作方法
3. 创建对应的组件文件
4. 在父组件中集成新功能

### 代码规范
- 使用 TypeScript 严格模式
- 遵循 React Hooks 规范
- 组件文件使用 PascalCase 命名
- 工具函数使用 camelCase 命名

## 🚧 开发中功能

### 即将推出
- [ ] 关系图谱可视化
- [ ] 数据导入/导出
- [ ] 协作编辑
- [ ] 版本历史
- [ ] 主题自定义
- [ ] 插件系统

### 性能优化
- [ ] 虚拟滚动
- [ ] 事件分片渲染
- [ ] 状态持久化
- [ ] 离线支持

## 🐛 已知问题

### 当前限制
1. 大量事件渲染可能影响性能（>1000个）
2. 对象关系功能仍在开发中
3. 导入导出功能待完善

### 解决方案
1. 计划实现虚拟滚动优化
2. 关系功能将在下个版本发布
3. 支持多种数据格式的导入导出

## 📝 更新日志

### v2.0.0 (2024-01-XX)
- ✨ 新增：检查器实时编辑功能
- 🔄 重构：对象管理从时间轴移至侧边栏
- 🎨 优化：全新的对象列表弹窗设计
- 🐛 修复：选择状态同步问题
- 📱 改进：响应式布局优化

### v1.0.0 (2024-01-XX)
- 🎉 初始版本发布
- ⚡ 基础时间轴功能
- 👥 对象管理系统
- 🎨 现代化UI设计

## 🤝 贡献指南

### 参与开发
1. Fork 项目
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 提交 Pull Request

### 报告问题
- 使用 GitHub Issues 报告 Bug
- 提供详细的复现步骤
- 包含系统环境信息

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。

## 🙏 致谢

感谢所有为此项目做出贡献的开发者和社区成员！

---

**开发团队** | **文档更新时间**: 2024-01-XX | **版本**: v2.0.0